function unChart(e,t){this.w=e;this.h=t;this.padding={left:30,right:30,top:30,bottom:30};this.innerWidth=this.w-this.padding.left-this.padding.right;this.innerHeight=this.h-this.padding.top-this.padding.bottom;this.innerTop=this.h-this.padding.top;this.data=this.base={data:"default"};this.speed=300;this.sliderValue=0;this.dScale=d3.time.scale().range([this.padding.left,this.w-this.padding.right]);this.yScale=d3.scale.linear().range([this.innerTop,this.padding.bottom]);this.xAxis=d3.svg.axis().scale(this.dScale).orient("bottom").ticks(5);this.yAxis=d3.svg.axis().scale(this.yScale).orient("left").ticks(5);this.svg=null;this.sliderX=null;this.container=null;this.slideAxis=d3.svg.axis().scale(this.dScale).orient("bottom").ticks(5)}p=unChart.prototype;p.build=function(e){e=typeof e!="undefined"?e:"body";this.container=d3.select(e);this.svg=this.container.append("svg").attr({width:this.w,height:this.h,"class":"chart"});this.svg.append("g").attr("class","x axis").attr("transform","translate(0,"+(this.h-this.padding.bottom)+")").call(this.xAxis);this.svg.append("g").attr("class","y axis").attr("transform","translate("+this.padding.left+",0)").call(this.yAxis);this.svg.append("path").attr("class"," line base");this.svg.append("path").attr("class"," line current")};Object.defineProperty(p,"dataset",{get:function(){return this.data},set:function(e){this.data=e;air.trace("DATASET RECEIVED");this.update()}});Object.defineProperty(p,"baseline",{get:function(){return this.base},set:function(e){this.base=e;air.trace("DATASET RECEIVED");this.drawBase()}});p.update=function(){ys=this.yScale;sv=this.svg;ys.domain([0,d3.max(this.data,function(e){return e.value})]);sv.select(".line.current").datum(this.data).transition().duration(this.speed).attr("d",this.line);$.event.trigger({type:"SLIDER",observation:this.data[this.sliderValue],base:this.base[this.sliderValue]})};p.drawBase=function(){console.log("drawing Baseline");ds=this.dScale;ys=this.yScale;sv=this.svg;this.line=d3.svg.line().x(function(e){return ds(e.jsDate)}).y(function(e){return ys(e.value)}).interpolate("linear");ds.domain(d3.extent(this.base,function(e,t){return e.jsDate}));ys.domain([0,d3.max(this.base,function(e){return e.value})]);sv.select(".x.axis").transition().duration(this.speed).call(this.xAxis);sv.select(".y.axis").transition().duration(this.speed).call(this.yAxis);console.log("Current Position : "+this.sliderValue);this.slide=d3.slider().min(0).max(this.base.length-1);this.container.select(".d3-slider").remove();var e=this,t=function(t,n){e.sliderValue=n;$.event.trigger({type:"SLIDER",observation:e.data[n],base:e.base[n]})};this.container.append("div").attr("class","x axis slider").style({width:this.innerWidth,"margin-left":this.padding.left-1}).call(this.slide.value(this.sliderValue));this.slide.on("slide",t);var n=this.container.select(".d3-slider-handle");n.append("div").attr("class","arrow left");n.append("div").attr("class","arrow right");sv.select(".x.axis").transition().duration(this.speed).call(this.xAxis);sv.select(".y.axis").transition().duration(this.speed).call(this.yAxis);sv.select(".line").datum(this.base).transition().duration(this.speed).attr("class","line base").attr("d",this.line)};